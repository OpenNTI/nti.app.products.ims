/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/zope.configuration-4.1.0-py2.7.egg/zope/configuration/fields.py:160: UserWarning: You did not specify an i18n translation domain for the 'title' field in /Users/sheldon.smith/Projects/nti.dataserver-buildout/etc/package-includes/666-roles.zcml
  "'%s' field in %s" % (self.getName(), context.info.file )
/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/zope.configuration-4.1.0-py2.7.egg/zope/configuration/fields.py:160: UserWarning: You did not specify an i18n translation domain for the 'description' field in /Users/sheldon.smith/Projects/nti.dataserver-buildout/etc/package-includes/666-roles.zcml
  "'%s' field in %s" % (self.getName(), context.info.file )
.E.............
======================================================================
ERROR: DSInjectorMixin ConfiguringLayerMixin GCLayerMixin PyramidLayerMixin SharedCleanupLayer ZopeComponentLayer ApplicationTestLayer test_launch (src.nti.app.products.ims.tests.test_views.TestToolViews)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.dataserver/src/nti/dataserver/tests/mock_dataserver.py", line 146, in f
    func( *args )
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.app.testing/src/nti/app/testing/decorators.py", line 117, in f
    func(self)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.app.products.ims/src/nti/app/products/ims/tests/test_views.py", line 94, in test_launch
    params=request.body, status=303)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.app.testing/src/nti/app/testing/webtest.py", line 43, in f
    return getattr( super(_UnicodeTestApp,self), name )( str(path), *args, **kwargs )
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/WebTest-2.0.27-py2.7.egg/webtest/app.py", line 378, in post
    content_type=content_type)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/WebTest-2.0.27-py2.7.egg/webtest/app.py", line 747, in _gen_request
    expect_errors=expect_errors)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/WebTest-2.0.27-py2.7.egg/webtest/app.py", line 643, in do_request
    self._check_status(status, res)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/WebTest-2.0.27-py2.7.egg/webtest/app.py", line 678, in _check_status
    "Bad response: %s (not %s)\n%s", res_status, status, res)
AppError: Bad response: 400 Bad Request (not 303)
400 Bad Request

The server could not comply with the request since it is either malformed or otherwise incorrect.


Unknown tool consumer



-------------------- >> begin captured logging << --------------------
txn.GLOBAL: DEBUG: new transaction
txn.GLOBAL: DEBUG: abort
txn.GLOBAL: DEBUG: new transaction
txn.GLOBAL: DEBUG: commit
txn.GLOBAL: DEBUG: new transaction
txn.GLOBAL: DEBUG: commit
zope.generations: INFO: Users: evolving in mode EVOLVEMINIMUM
zope.generations: DEBUG: Users/nti.dataserver: up-to-date at generation 85
zope.generations: DEBUG: Users/nti.dataserver-AAA.contenttypes.courses: up-to-date at generation 30
zope.generations: DEBUG: Users/nti.dataserver-analytics: up-to-date at generation 45
zope.generations: DEBUG: Users/nti.dataserver-analytics_registration: up-to-date at generation 3
zope.generations: DEBUG: Users/nti.dataserver-app-assessment: up-to-date at generation 35
zope.generations: DEBUG: Users/nti.dataserver-app-contentlibrary: up-to-date at generation 8
zope.generations: DEBUG: Users/nti.dataserver-app-contentlibrary-rendering: up-to-date at generation 6
zope.generations: DEBUG: Users/nti.dataserver-app-contenttypes-presentation: up-to-date at generation 47
zope.generations: DEBUG: Users/nti.dataserver-app-products-courseware: up-to-date at generation 17
zope.generations: DEBUG: Users/nti.dataserver-app-solr: up-to-date at generation 4
zope.generations: DEBUG: Users/nti.dataserver-contentsearch: up-to-date at generation 33
zope.generations: DEBUG: Users/nti.dataserver-courseware-badges: up-to-date at generation 4
zope.generations: DEBUG: Users/nti.dataserver-courseware-store: up-to-date at generation 4
zope.generations: DEBUG: Users/nti.dataserver-metadata: up-to-date at generation 6
zope.generations: DEBUG: Users/nti.dataserver-ntibadges: up-to-date at generation 4
zope.generations: DEBUG: Users/nti.dataserver-products-gradebook: up-to-date at generation 9
zope.generations: DEBUG: Users/nti.dataserver-recorder: up-to-date at generation 2
zope.generations: DEBUG: Users/nti.dataserver-store: up-to-date at generation 12
zope.generations: DEBUG: Users/nti.dataserver:nti.app.client_preferences: up-to-date at generation 2
zope.generations: DEBUG: Users/nti.dataserver:nti.app.products.ou: up-to-date at generation 9
zope.generations: DEBUG: Users/nti.dataserver:nti.app.sites.okstate: up-to-date at generation 2
txn.GLOBAL: DEBUG: new transaction
txn.GLOBAL: DEBUG: commit
nti.zodb.activitylog: INFO: closedConnection={'loads':     2, 'stores':     0, 'database': Users}
requests_oauthlib.oauth1_auth: DEBUG: Signing request <PreparedRequest [POST]> using client <Client nonce=None, signature_method=HMAC-SHA1, realm=None, encoding=utf-8, timestamp=None, resource_owner_secret=None, decoding=utf-8, verifier=None, signature_type=BODY, rsa_key=None, resource_owner_key=None, client_secret=****, callback_uri=None, client_key=does not>
requests_oauthlib.oauth1_auth: DEBUG: Including body in call to sign: True
oauthlib.oauth1.rfc5849: DEBUG: Collected params: [(u'resource_link_id', u'linkid'), (u'lti_version', u'LTI-1.0'), (u'lti_message_type', u'basic-lti-launch-request'), (u'oauth_nonce', u'102215669467075912951500327411'), (u'oauth_timestamp', u'1500327411'), (u'oauth_version', u'1.0'), (u'oauth_signature_method', u'HMAC-SHA1'), (u'oauth_consumer_key', u'does not')]
oauthlib.oauth1.rfc5849: DEBUG: Normalized params: lti_message_type=basic-lti-launch-request&lti_version=LTI-1.0&oauth_consumer_key=does%20not&oauth_nonce=102215669467075912951500327411&oauth_signature_method=HMAC-SHA1&oauth_timestamp=1500327411&oauth_version=1.0&resource_link_id=linkid
oauthlib.oauth1.rfc5849: DEBUG: Normalized URI: http://localhost/dataserver2/IMS/LTI/TOOLS/launch
oauthlib.oauth1.rfc5849: DEBUG: Base signing string: POST&http%3A%2F%2Flocalhost%2Fdataserver2%2FIMS%2FLTI%2FTOOLS%2Flaunch&lti_message_type%3Dbasic-lti-launch-request%26lti_version%3DLTI-1.0%26oauth_consumer_key%3Ddoes%2520not%26oauth_nonce%3D102215669467075912951500327411%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1500327411%26oauth_version%3D1.0%26resource_link_id%3Dlinkid
oauthlib.oauth1.rfc5849: DEBUG: Signature: 96ibljgRRURO0k3LM6ILGI2WCjE=
oauthlib.oauth1.rfc5849: DEBUG: Encoding URI, headers and body to utf-8.
requests_oauthlib.oauth1_auth: DEBUG: Updated url: http://localhost/dataserver2/IMS/LTI/TOOLS/launch
requests_oauthlib.oauth1_auth: DEBUG: Updated headers: {'Content-Length': '85', 'Content-Type': 'application/x-www-form-urlencoded'}
requests_oauthlib.oauth1_auth: DEBUG: Updated body: 'resource_link_id=linkid&lti_version=LTI-1.0&lti_message_type=basic-lti-launch-request&oauth_nonce=102215669467075912951500327411&oauth_timestamp=1500327411&oauth_version=1.0&oauth_signature_method=HMAC-SHA1&oauth_consumer_key=does+not&oauth_signature=96ibljgRRURO0k3LM6ILGI2WCjE%3D'
txn.GLOBAL: DEBUG: new transaction
nti.appserver.tweens.zope_site_tween: DEBUG: Should not have a site already in place: <zope.site.site.SiteManagerContainer object at 0x108630650>
Traceback (most recent call last):
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.dataserver/src/nti/appserver/tweens/zope_site_tween.py", line 221, in _debug_site
    "Should not have a site already in place"
AssertionError: Should not have a site already in place
nti.app.products.ims.views: ERROR: Invalid LTI Request
Traceback (most recent call last):
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.app.products.ims/src/nti/app/products/ims/views.py", line 144, in __call__
    IToolProvider)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/zope.component-4.3.0-py2.7.egg/zope/component/_api.py", line 123, in queryMultiAdapter
    return sitemanager.queryMultiAdapter(objects, interface, name, default)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/zope.interface-4.4.2-py2.7-macosx-10.6-intel.egg/zope/interface/registry.py", line 359, in queryMultiAdapter
    objects, interface, name, default)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/zope.interface-4.4.2-py2.7-macosx-10.6-intel.egg/zope/interface/adapter.py", line 552, in queryMultiAdapter
    result = factory(*objects)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.app.products.ims/src/nti/app/products/ims/launch.py", line 65, in _provider_factory
    request.headers)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/lti-0.9.2-py2.7.egg/lti/tool_provider.py", line 31, in from_unpacked_request
    raise InvalidLTIRequestError("oauth_consumer_key not found!")
InvalidLTIRequestError: 'oauth_consumer_key not found!'
txn.GLOBAL: DEBUG: abort
nti.transactions.transactions: DEBUG-5: Aborted doomed or vetoed transaction for None in 8.60691070557e-05s
nti.zodb.activitylog: INFO: closedConnection={'loads':     6, 'stores':     0, 'database': Users}
txn.GLOBAL: DEBUG: new transaction
txn.GLOBAL: DEBUG: commit <Connection at 108630210>
txn.GLOBAL: DEBUG: commit
nti.zodb.activitylog: INFO: closedConnection={'loads':     8, 'stores':     2, 'database': Users}
requests_oauthlib.oauth1_auth: DEBUG: Signing request <PreparedRequest [POST]> using client <Client nonce=None, signature_method=HMAC-SHA1, realm=None, encoding=utf-8, timestamp=None, resource_owner_secret=None, decoding=utf-8, verifier=None, signature_type=BODY, rsa_key=None, resource_owner_key=None, client_secret=****, callback_uri=None, client_key=foonextthoughtcom>
requests_oauthlib.oauth1_auth: DEBUG: Including body in call to sign: True
oauthlib.oauth1.rfc5849: DEBUG: Collected params: [(u'resource_link_id', u'linkid'), (u'lti_version', u'LTI-1.0'), (u'lti_message_type', u'basic-lti-launch-request'), (u'oauth_nonce', u'113329382757523662671500327411'), (u'oauth_timestamp', u'1500327411'), (u'oauth_version', u'1.0'), (u'oauth_signature_method', u'HMAC-SHA1'), (u'oauth_consumer_key', u'foonextthoughtcom')]
oauthlib.oauth1.rfc5849: DEBUG: Normalized params: lti_message_type=basic-lti-launch-request&lti_version=LTI-1.0&oauth_consumer_key=foonextthoughtcom&oauth_nonce=113329382757523662671500327411&oauth_signature_method=HMAC-SHA1&oauth_timestamp=1500327411&oauth_version=1.0&resource_link_id=linkid
oauthlib.oauth1.rfc5849: DEBUG: Normalized URI: http://localhost/dataserver2/IMS/LTI/TOOLS/launch
oauthlib.oauth1.rfc5849: DEBUG: Base signing string: POST&http%3A%2F%2Flocalhost%2Fdataserver2%2FIMS%2FLTI%2FTOOLS%2Flaunch&lti_message_type%3Dbasic-lti-launch-request%26lti_version%3DLTI-1.0%26oauth_consumer_key%3Dfoonextthoughtcom%26oauth_nonce%3D113329382757523662671500327411%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1500327411%26oauth_version%3D1.0%26resource_link_id%3Dlinkid
oauthlib.oauth1.rfc5849: DEBUG: Signature: JhlBPua2A4ygPtd8ZmpgMi/C/CM=
oauthlib.oauth1.rfc5849: DEBUG: Encoding URI, headers and body to utf-8.
requests_oauthlib.oauth1_auth: DEBUG: Updated url: http://localhost/dataserver2/IMS/LTI/TOOLS/launch
requests_oauthlib.oauth1_auth: DEBUG: Updated headers: {'Content-Length': '85', 'Content-Type': 'application/x-www-form-urlencoded'}
requests_oauthlib.oauth1_auth: DEBUG: Updated body: 'resource_link_id=linkid&lti_version=LTI-1.0&lti_message_type=basic-lti-launch-request&oauth_nonce=113329382757523662671500327411&oauth_timestamp=1500327411&oauth_version=1.0&oauth_signature_method=HMAC-SHA1&oauth_consumer_key=foonextthoughtcom&oauth_signature=JhlBPua2A4ygPtd8ZmpgMi%2FC%2FCM%3D'
txn.GLOBAL: DEBUG: new transaction
nti.app.products.ims.views: ERROR: Invalid LTI Request
Traceback (most recent call last):
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.app.products.ims/src/nti/app/products/ims/views.py", line 153, in __call__
    ISessionProvider(lti_request).provision()
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/zope.component-4.3.0-py2.7.egg/zope/component/hooks.py", line 119, in adapter_hook
    return siteinfo.adapter_hook(interface, object, name, default)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/sources/nti.app.products.ims/src/nti/app/products/ims/finder.py", line 33, in __init__
    request.headers)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/lti-0.9.2-py2.7.egg/lti/tool_provider.py", line 28, in from_unpacked_request
    launch_params = LaunchParams(params)
  File "/Users/sheldon.smith/Projects/nti.dataserver-buildout/eggs/lti-0.9.2-py2.7.egg/lti/launch_params.py", line 159, in __init__
    self.update(*args, **kwargs)
  File "/Users/sheldon.smith/.virtualenvs/nti.dataserver-buildout/bin/../lib/python2.7/_abcoll.py", line 571, in update
    for key, value in other:
ValueError: need more than 1 value to unpack
txn.GLOBAL: DEBUG: abort
nti.transactions.transactions: DEBUG-5: Aborted doomed or vetoed transaction for None in 0.00010085105896s
nti.zodb.activitylog: INFO: closedConnection={'loads':     7, 'stores':     0, 'database': Users}
nti.analytics.database.zcml: INFO: Resetting AnalyticsDB
nti.analytics.database.database: INFO: Connecting to database at 'sqlite://' (twophase=False) (testmode=True)
nti.analytics.database.metadata: INFO: Initializing database
--------------------- >> end captured logging << ---------------------
----------------------------------------------------------------------
Ran 15 tests in 31.957s

FAILED (errors=1)
